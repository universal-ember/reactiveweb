{"version":3,"file":"throttle.js","sources":["../src/throttle.ts"],"sourcesContent":["import { cell, resource } from 'ember-resources';\n\n/**\n * A utility that creates a resource allowing us to throttle execution of a function.\n * Especially useful for rate limiting execution of handlers on events like resize and scroll.\n *\n * ```js\n *  import Component from '@glimmer/component';\n *  import { tracked } from '@glimmer/tracking';\n *  import { use } from 'ember-resources';\n *  import { throttle } from 'reactiveweb/throttle';\n *\n *  class Demo extends Component {\n *    @tracked _userInput = 'initial';\n *\n *    // immediately returns 'initial', and all updates will be throttled\n *    // to update only after 100ms since the last value was detected.\n *    @use userInput  = throttle(100, () => this._userInput);\n * ```\n *\n * @param delay A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param callback A function to be executed after delay milliseconds.\n */\nexport function throttle<Value = unknown>(delay: number, callback: () => Value) {\n  const state = cell<Value | undefined>();\n  let last: unknown;\n\n  return resource(({ on }) => {\n    let timer: number;\n\n    on.cleanup(() => clearTimeout(timer));\n\n    timer = setTimeout(() => (state.current = callback()), delay);\n    last = last ?? callback();\n\n    return (state.current ?? last) as Value;\n  });\n}\n"],"names":["throttle","delay","callback","state","cell","last","resource","on","timer","cleanup","clearTimeout","setTimeout","current"],"mappings":";;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,QAAQA,CAAkBC,KAAa,EAAEC,QAAqB,EAAE;AAC9E,EAAA,MAAMC,KAAK,GAAGC,IAAI,EAAqB,CAAA;AACvC,EAAA,IAAIC,IAAa,CAAA;EAEjB,OAAOC,QAAQ,CAAC,CAAC;AAAEC,IAAAA,EAAAA;AAAG,GAAC,KAAK;AAC1B,IAAA,IAAIC,KAAa,CAAA;IAEjBD,EAAE,CAACE,OAAO,CAAC,MAAMC,YAAY,CAACF,KAAK,CAAC,CAAC,CAAA;AAErCA,IAAAA,KAAK,GAAGG,UAAU,CAAC,MAAOR,KAAK,CAACS,OAAO,GAAGV,QAAQ,EAAG,EAAED,KAAK,CAAC,CAAA;AAC7DI,IAAAA,IAAI,GAAGA,IAAI,IAAIH,QAAQ,EAAE,CAAA;AAEzB,IAAA,OAAQC,KAAK,CAACS,OAAO,IAAIP,IAAI,CAAA;AAC/B,GAAC,CAAC,CAAA;AACJ;;;;"}